import numpy as np 
import pandas as pd 
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier

train = pd.read_csv('/kaggle/input/digit-recognizer/train.csv')
test = pd.read_csv('/kaggle/input/digit-recognizer/test.csv')

X_train, X_test, y_train, y_test = train_test_split(train.drop(['label'],axis=1), train.label, test_size=0.2,random_state=42)

forest = RandomForestClassifier(n_estimators=500)
forest.fit(X_train, y_train)
y_pred = forest.predict(X_test)

y_test_pred = tree.predict(test)
total = pd.DataFrame({'ImageId': test.index+1, 'Label': y_test_pred})
total.to_csv("Digit_Rec_Forest.csv", index=False)
total
